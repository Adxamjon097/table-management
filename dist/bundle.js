!function(t){var e={};function a(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,a),o.l=!0,o.exports}a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e){$(document).ready((function(){let t=$("button#add"),e=$("#content"),a=$("#save");var n=$("#update-table-id").length>0?$("#update-table-id").val():null;let o=[],l=[],p=null,r=null;function s(t){$("div#types").html("");let e=$("<table class='table table-striped'>"),a=$("<tr>");for(let e=0;e<t.length;e++){let n=$("<td>"),o=$('<div class="wrap">'),l=$('<div class="left">'),p=$('<div class="form-group active">'),r=$('<div class="form-group active">'),s=$('<div class="form-group formula '+(4==t[e].type?"active":"")+'">'),i=$('<div class="form-group table '+(5==t[e].type?"active":"")+'">'),c=$('<div class="form-group table '+(5==t[e].type?"active":"")+'">'),u=$('<div class="form-group table '+(5==t[e].type?"active":"")+'">'),d=$('<div class="addInput"></div>'),f=$('<div class="form-group last select '+(2==t[e].type?"active":"")+'"></div>'),v=$('<a href="#!" class="addInput"><i class="fa fa-plus"></i></a>'),m=$("<select class='type-select form-control'>").val(t[e].type).change((function(){t[e].type=$(this).val()})),h=$('<option value="1" '+(1==t[e].type?"selected":"")+">number</option>"),b=$('<option value="2" '+(2==t[e].type?"selected":"")+">select</option>"),y=$('<option value="3" '+(3==t[e].type?"selected":"")+">text</option>"),g=$('<option value="4" '+(4==t[e].type?"selected":"")+">formula</option>"),T=$('<option value="5" '+(5==t[e].type?"selected":"")+">table</option>"),x=$('<option value="6" '+(6==t[e].type?"selected":"")+">date</option>"),w=$('<option value="7" '+(7==t[e].type?"selected":"")+">numberation</option>"),k=$("<input type='text' class='form-control' placeholder='name'>").val(t[e].name).change((function(){t[e].name=$(this).val()})),j=$("<input type='text' class='form-control' placeholder='formula'>").val(t[e].formula).change((function(){t[e].formula=$(this).val()})),O=$("<input type='text' class='form-control' placeholder='table'>").val(t[e].table).change((function(){t[e].table=$(this).val()})),S=$("<input type='text' class='form-control' placeholder='key'>").val(t[e].key).change((function(){t[e].key=$(this).val()})),M=$("<input type='text' class='form-control' placeholder='value'>").val(t[e].value).change((function(){t[e].value=$(this).val()}));h.appendTo(m),b.appendTo(m),y.appendTo(m),g.appendTo(m),T.appendTo(m),x.appendTo(m),w.appendTo(m),j.appendTo(s),m.appendTo(p),k.appendTo(r),O.appendTo(i),S.appendTo(c),M.appendTo(u),r.appendTo(l),p.appendTo(l);for(let a=0;t[e].variants&&a<t[e].variants.length;a++){let n=$("<input type='text' name='variant' class='form-control' placeholder='variants'>").val(t[e].variants[a]).change((function(){t[e].variants[$(this).closest("td").find("input[name=variant]").index(this)]=$(this).val()})),o=$('<div class="form-group select item input-group '+(0==a?" first ":"")+(2==t[e].type?"active":"")+'">');n.appendTo(o),$('<span class="input-group-btn"><button class="btn btn-default"><i class="fa fa-minus"></i></button></span>').appendTo(o),o.appendTo(l)}if(!t[e].variants||t[e].variants&&0==t[e].variants.length){t[e].variants||(t[e].variants=[]);let a=$("<input type='text' name='variant' class='form-control' placeholder='variants'>").change((function(){t[e].variants[$(this).closest("td").find("input[name=variant]").index(this)]=$(this).val()})),n=$('<div class="form-group select item input-group first '+(2==t[e].type?"active":"")+'">');a.appendTo(n),$('<span class="input-group-btn"><button class="btn btn-default"><i class="fa fa-minus"></i></button></span>').appendTo(n),n.appendTo(l)}s.appendTo(l),i.appendTo(l),c.appendTo(l),u.appendTo(l),d.appendTo(l),v.appendTo(f),f.appendTo(l),l.appendTo(o),o.appendTo(n),n.appendTo(a)}a.appendTo(e),e.appendTo("div#types")}function i(t){!function(t){var e,a=new Array(t.length).fill(0);for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++)if(a[e]+=t[e][n].colspan,t[e][n].rowspan>1)for(let o=e+1;o<=e+t[e][n].rowspan-1;o++)a[o]+=t[e][n].colspan;e=Math.max(...a);for(let n=0;n<a.length;n++)if(a[n]!=e)for(let o=0;o<e-a[n];o++)t[n].push({name:"",name:"",rowspan:1,colspan:1,x:n,y:t[n].length})}(t),$("div#table").html("");let e=$("<table class='table table-striped'>");for(let a=0;a<t.length;a++){let n=$("<tr>");for(let e=0;e<t[a].length;e++){let o=$("<td tabindex='1'>").attr("colspan",t[a][e].colspan).attr("rowspan",t[a][e].rowspan);$("<input>").val(t[a][e].name).change((function(){t[a][e].name=$(this).val(),console.log(t[a][e].name)})).appendTo(o),o.appendTo(n);let l=$("<div class='icons'>").appendTo(o);$("<span>x</span>").appendTo(l);if(e!=t[a].length-1){$("<a>").html('<i class="fa fa-arrow-right"></i>').click((function(){for(let n=0;n<t.length;n++)t[n][e+1]&&a-n==t[n][e+1].rowspan-1&&t[n][e+1].rowspan--;let n=t[a][e+1];t[a][e].colspan+=n.colspan;for(let n=a;n<=a+t[a][e].rowspan-1;n++)n==a?t[n].splice(e+1,1):t[n].pop();i(t)})).appendTo(l)}if(t[a][e].colspan>1){$("<a>").html('<i class="fa fa-arrow-left"></i>').click((function(){t[a][e].colspan--;for(let n=a;n<a+t[a][e].rowspan;n++)t[n].push({name:"",rowspan:1,colspan:1,x:n,y:t[n].length});i(t)})).appendTo(l)}if(t[a][e].rowspan>1){$("<a>").html('<i class="fa fa-arrow-up"></i>').click((function(){t[a][e].rowspan--;for(let n=0;n<t[a][e].colspan;n++)t[a+t[a][e].rowspan].push({name:"",rowspan:1,colspan:1,x:a+t[a][e].rowspan,y:t[a+t[a][e].rowspan].length});i(t)})).appendTo(l)}if(a+t[a][e].rowspan-1!=t.length-1){$("<a>").html('<i class="fa fa-arrow-down"></i>').click((function(){for(let n=0;n<t[a][e].colspan;n++){let n=t[a+t[a][e].rowspan];n&&n.pop()}t[a][e].rowspan++,i(t)})).appendTo(l)}}n.appendTo(e)}e.appendTo("div#table")}if(a.click((function(){(function(){var t=!1;return $("#table input").each((function(e,a){""==$(a).val()?($(a).css({border:"1px solid #E64320"}),t=!0):$(a).css({border:"1px solid #ccc"})})),$("#types input").each((function(e,a){$(a).closest(".form-group").hasClass("active")&&""==$(a).val()?($(a).css({border:"1px solid #E64320"}),t=!0):$(a).css({border:"1px solid #ccc"})})),t})()||function(t,e,a,n,o=null){t.length>0&&e.length>0&&a&&n&&$.ajax({method:"POST",data:{matrix:t,types:e,count:a,name:n,id:o},url:"http://eko.md.uz/api/default/index"}).done((function(t){"ok"==t.status&&(document.location=$("#route").data("url"))}))}(o,l,p,r,n)})),t.click((function(){let t=$("input#n").val(),a=$("input#m").val();if(p=$("input#k").val(),r=$("input#table-name").val(),t&&a&&p&&t>0&&a>0&&p>0&&r&&""!=r){e.show(),o=[],l=[];for(let e=0;e<a;e++){o[e]=[];for(let a=0;a<t;a++)o[e][a]={name:"",colspan:1,rowspan:1,x:e,y:a}}for(let e=0;e<t;e++)l[e]={type:1,variants:[],name:"",formula:"",table:"",key:"",value:""};i(o),s(l)}!t||t<=0?$("#n-error").text("Укажите значение N"):$("#n-error").text(""),!a||a<=0?$("#m-error").text("Укажите значение M"):$("#m-error").text(""),!p||p<=0?$("#k-error").text("Укажите значение K"):$("#k-error").text(""),!r||r<=0?$("#table-name-error").text("Укажите название таблицы"):$("#table-name-error").text("")})),$("#update-table-form").length>0){let t=$("#update-table-matrix-json").val(),e=$("#update-table-types-json").val(),a=$("#update-table-count").val(),n=$("#update-table-name").val();o=JSON.parse(t),l=JSON.parse(e),p=a,r=n,i(o),s(l)}}))}]);